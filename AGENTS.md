# AGENTS

このファイルは、このリポジトリで自律型コーディングエージェントがどのように動作するかを定義します。

## 1. 目的

- 次の構成を持つ TypeScript モノレポを開発・保守する:
  - `apps/api` の REST API
  - 上記 API を利用する `apps/web` の Web UI

## 2. 作業ルール

- 変更は小さく段階的に行う。
- API と Web の責務分離を維持する。
- 秘密情報をコミットしない。
- 完了提案前に関連チェックを実行する（`typecheck`、`build`、テストがあればテスト）。
- 挙動や契約を変更した場合はドキュメントも更新する。
- いわゆる「車輪の再発明」を避ける。実装前に、標準ライブラリや既存の信頼できるライブラリで解決できないか確認する。
- 自前実装より、保守実績のある枯れたライブラリを優先する。自前実装を選ぶ場合は理由を明記する。
- テスト実装は既存のテスト基盤を使う。API は Vitest + Supertest、Web は Vitest + Testing Library + jsdom を標準とする。
- 既存のテストフレームワークと混在させず、原則 `npm run test -w apps/api` / `npm run test -w apps/web` で実行可能な形に統一する。

## 3. アーキテクチャ参照

- 構造的な変更を行う前に `docs/architecture.md` を読む。
- 変更内容が `docs/architecture.md` と不整合になる場合は、同一タスクでコードと設計書を同時に更新する。
- 境界、データフロー、規約の正本は `docs/architecture.md` とする。

## 4. API 契約ルール

- API エンドポイントの追加・変更時は `apps/api/openapi.yaml` を必ず更新する。
- 実装と OpenAPI 契約の整合を維持する。

## 5. 環境変数ルール

- 新たに必須となる環境変数は、安全なプレースホルダー値付きで `.env.example` に追加する。
- 実際の認証情報は追跡対象ファイルに置かない。
