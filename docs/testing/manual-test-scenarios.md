# 手動テストシナリオ（T-014）

## 1. 目的

MVP の主要ユーザーフローを人間の実操作で確認し、受け入れ可否を判定する。

## 2. 実施前提

- `nvm use 20` などで Node v20 系を利用する
- ルートで `npm install`
- `npm run dev:api` と `npm run dev:web` を別ターミナルで起動
- API: `http://localhost:3001`
- Web: `http://localhost:5173`
- テストデータは `docs/testing/data/` 直下の ENEX ファイルを利用する

## 3. テストデータ

| ファイル名      | 目的                               | 備考                                              |
| --------------- | ---------------------------------- | ------------------------------------------------- |
| `small.enex`    | 正常系確認（10 件）                | タグ/タイムスタンプを含む標準データセット         |
| `medium.enex`   | 100 件規模での体感性能・ページング | 長時間操作で検索・ページングのストレスを確認      |
| `warnings.enex` | エンコード警告表示                 | 2 件中 1 件が本文欠落のため API が warning を返す |
| `broken.enex`   | XML 破損のエラー挙動               | パース不能なファイルでエラー UI を確認            |

> 必要に応じて `docs/testing/data/` を配布。別環境で再生成したい場合は Node スクリプトを用意しておくと便利（例: `node scripts/generate-enex-fixtures.mjs` など）。

## 4. シナリオ

### MT-001 正常アップロード（small）

- 手順:
  1. Web を開く
  2. `small.enex` を選択してアップロード
- 期待結果:
  - 処理が完了し、エラー表示が出ない
  - 一覧表示に必要な情報（importId/件数）が確認できる

### MT-002 一覧表示とページング

- 手順:
  1. `small.enex` 取り込み後の一覧を確認
  2. ページングボタンを往復
- 期待結果:
  - タイトル、日時、タグ/抜粋が表示される
  - 件数表示が import 結果と一致する
  - ページングで重複選択やエラーが発生しない

### MT-003 検索とクエリ検証

- 手順:
  1. `small.enex` 取り込み後、既知キーワードで検索
  2. 非一致キーワードで検索
  3. ブラウザのアドレスバーに `?limit=-1` を付与して一覧を再読込
- 期待結果:
  - 一致ノートのみ表示される
  - 非一致では 0 件表示となる
  - 無効な limit では API が 400 を返し UI にエラーが表示される（クラッシュしない）

### MT-004 ノート詳細とサニタイズ

- 手順:
  1. 一覧から任意ノートを選択
  2. DevTools で HTML を確認し危険なタグ実行がないか確認
- 期待結果:
  - タイトル、日時、タグ、本文、添付情報が表示される
  - 表示崩れや危険な HTML 実行がない

### MT-005 解析エラー（`broken.enex`）

- 手順:
  1. `broken.enex` をアップロード
- 期待結果:
  - エラーメッセージが表示される
  - 画面が操作不能にならない

### MT-006 警告表示（`warnings.enex`）

- 手順:
  1. `warnings.enex` をアップロード
  2. 結果ダイアログに warning 数が表示されることを確認
- 期待結果:
  - warning バッジが表示される
  - 一部ノートが欠落しても UI は操作可能

### MT-007 体感性能（`medium.enex`）

- 手順:
  1. `medium.enex` をアップロード
  2. 一覧表示、検索、詳細表示を操作
- 期待結果:
  - 著しい遅延やフリーズがない

### MT-008 レスポンシブ表示

- 手順:
  1. 開発者ツールでモバイル幅（例: 390x844）へ切替
  2. アップロード、一覧、詳細を確認
- 期待結果:
  - 主要操作が可能
  - 文字切れ/重なりが致命的でない

## 5. 結果記録テンプレート

- 実施日:
- 実施者:
- 対象ブランチ/コミット:

| ID     | 結果 (Pass/Fail) | メモ                                       |
| ------ | ---------------- | ------------------------------------------ |
| MT-001 | Pass             |                                            |
| MT-002 | Pass             |                                            |
| MT-003 | Fail             | limit オプションが動作しない               |
| MT-004 | Pass             |                                            |
| MT-005 | Fail             |                                            |
| MT-006 | Pass             |                                            |
| MT-007 | Pass             |                                            |
| MT-008 | Fail             | ノートの詳細表示部が右にはみ出ることがある |

## 6. 判定基準

- 重大不具合（操作不能、表示不能、クラッシュ）が 0 件
- MT-001〜MT-006 はすべて Pass
- MT-007/MT-008 はUX上重大な問題がない

## 7. テスト時メモ

- 検索条件を "Claer" ボタンではなく、入力フォームの右端にある x で消した場合に、検索結果が変わらない不具合
- 初期のスケルトンに含まれていた UI は不要
  - TypeScript REST API + Web UI
  - Hello from TypeScript REST API
  - 最下部のタイムスタンプ
- 上記スケルトン院含まれていた UI にまつわるバックエンドの実装も不要
- 画面のタイムスタンプの表記は ISO フォーマットのままでは無く、人間の読みやすい yyyy-mm-dd hh:mm:ss が望ましい
- 一覧をソートするオプションが欲しい
- 画面上に二つの一覧は不要
  - 下にある 2 ペインの UI のみ残し、そちらに検索機能を付けたい
